<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åº“å­˜æŸ¥çœ‹</title>
  <style>
    body {
      background: #f0f0f0;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    /* æ ‡é¢˜æ ·å¼ */
    h1 {
      text-align: center;
      font-size: 32px; /* ä¸çª—å£ç®¡ç†ä¸€è‡´ */
      margin: 0 0 10vh 0;
    }
    /* è¿”å›æŒ‰é’®åŒºåŸŸ */
    .back-button-container {
      width: 60%;
      margin: 0 auto 10px;
      text-align: left;
    }
    .back-button {
      padding: 6px 12px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background: #808080;  /* ç°è‰²èƒŒæ™¯ */
      color: #fff;
      cursor: pointer;
    }
    /* æ§åˆ¶åŒºï¼ˆæœç´¢ã€æ’åºã€åˆ·æ–°ã€æ‰¹é‡ä¿®æ”¹ã€æ·»åŠ å•†å“ï¼‰ */
    .controls {
      width: 60%;
      margin: 0 auto 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    }
    .left-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .search-box {
      display: inline-flex;
      align-items: center;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 3px 5px;
    }
    .search-box .search-icon {
      margin-right: 5px;
      font-size: 12px;
    }
    .search-box input {
      border: none;
      background: transparent;
      outline: none;
      font-size: 12px;
    }
    .left-controls select {
      padding: 3px 5px;
      font-size: 12px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .right-controls button {
      padding: 3px 7px;
      font-size: 12px;
      border: none;
      border-radius: 5px;
      background: #3498db;
      color: #fff;
      cursor: pointer;
      margin-left: 5px;
    }
    .right-controls button:hover {
      background: #2980b9;
    }
    /* è¡¨æ ¼å®¹å™¨ */
    .table-container {
      width: 60%;
      margin: 0 auto;
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    table th, table td {
      padding: 10px;
      text-align: center;
      border: 1px solid #ddd;
      font-size: 12px;
    }
    table th {
      background-color: #f2f2f2;
    }
    /* åˆ†é¡µæ§ä»¶ */
    .pagination {
      width: 60%;
      margin: 10px auto 0;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 5px;
      font-size: 12px;
    }
    .pagination select,
    .pagination input {
      padding: 3px;
      font-size: 12px;
    }
    .pagination button {
      padding: 3px 7px;
      font-size: 12px;
      cursor: pointer;
      background: #3498db;
      color: #fff;
      border: none;
      border-radius: 5px;
    }
    .pagination button:hover {
      background: #2980b9;
    }
    /* æ¨¡æ€çª—å£ï¼šæ·»åŠ å•†å“ */
    #addModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1100;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    #addModal .modal-content {
      background: #fff;
      width: 80%;
      max-width: 500px;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    #addModal .modal-header {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    #addModal .modal-back-btn {
      background: #3498db;
      border: none;
      border-radius: 5px;
      color: #fff;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
      margin-right: 10px;
    }
    #addModal h2 {
      font-size: 20px;
      margin: 0;
    }
    #addModal form div {
      margin-bottom: 10px;
    }
    #addModal form label {
      display: block;
      font-size: 14px;
      margin-bottom: 5px;
    }
    #addModal form input {
      width: 100%;
      padding: 8px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    #addModal .confirm-add-btn {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background: #808080;
      color: #fff;
      cursor: pointer;
      margin-top: 10px;
    }
    #addModal .confirm-add-btn:hover {
      background: #666666;
    }
  </style>
</head>
<body>
  <h1>åº“å­˜æŸ¥çœ‹</h1>

  <!-- è¿”å›æŒ‰é’®åŒºåŸŸ -->
  <div class="back-button-container">
    <button class="back-button" onclick="history.back();">è¿”å›</button>
  </div>

  <!-- æœç´¢ã€æ’åºã€åˆ·æ–°ã€æ‰¹é‡ä¿®æ”¹ã€æ·»åŠ å•†å“æ§ä»¶åŒºåŸŸ -->
  <div class="controls">
    <div class="left-controls">
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="searchInput" placeholder="åºå·/å•†å“åç§°/ä»·æ ¼">
      </div>
      <select id="sortSelect">
        <option value="default">é»˜è®¤</option>
        <option value="name">åç§°</option>
        <option value="priceAsc">ä»·æ ¼ï¼ˆå‡åºï¼‰</option>
        <option value="priceDesc">ä»·æ ¼ï¼ˆé™åºï¼‰</option>
        <option value="stock">æ•°é‡</option>
      </select>
    </div>
    <div class="right-controls">
      <button id="addProductBtn">æ·»åŠ å•†å“</button>
      <button id="batchBtn">æ‰¹é‡ä¿®æ”¹</button>
      <button id="refreshBtn">åˆ·æ–°</button>
    </div>
  </div>

  <!-- è¡¨æ ¼å®¹å™¨ -->
  <div class="table-container">
    <table id="inventory-table">
      <thead>
        <tr>
          <th>åºå·</th>
          <th>å•†å“åç§°</th>
          <th>è§„æ ¼</th>
          <th>é›¶å”®ä»·æ ¼</th>
          <th>åº“å­˜</th>
          <th>æ“ä½œ</th>
        </tr>
      </thead>
      <tbody>
        <!-- è¡¨æ ¼æ•°æ®ç”± JavaScript åŠ¨æ€ç”Ÿæˆ -->
      </tbody>
    </table>
  </div>

  <!-- åˆ†é¡µæ§ä»¶ -->
  <div class="pagination">
    <span>æ¯é¡µæ˜¾ç¤º</span>
    <select id="pageSize">
      <option value="10" selected>10æ¡</option>
      <option value="50">50æ¡</option>
      <option value="100">100æ¡</option>
    </select>
    <span>å½“å‰é¡µ: <span id="currentPage">1</span> / <span id="totalPages">?</span></span>
    <button id="prevPage">ä¸Šä¸€é¡µ</button>
    <button id="nextPage">ä¸‹ä¸€é¡µ</button>
    <span>è·³è½¬åˆ°</span>
    <input type="number" id="jumpPage" min="1" style="width:50px;">
    <button id="jumpBtn">è·³è½¬</button>
  </div>

  <!-- æ¨¡æ€çª—å£ï¼šæ·»åŠ å•†å“ -->
  <div id="addModal">
    <div class="modal-content">
      <div class="modal-header">
        <button class="modal-back-btn" onclick="closeAddModal()">è¿”å›</button>
        <h2>æ·»åŠ å•†å“</h2>
      </div>
      <form id="addProductForm">
        <div>
          <label for="newBarcode">å•†å“æ¡ç ï¼š</label>
          <input type="text" id="newBarcode" required>
        </div>
        <div>
          <label for="newName">å•†å“åç§°ï¼š</label>
          <input type="text" id="newName" required>
        </div>
        <div>
          <label for="newUnit">å•†å“å•ä½ï¼š</label>
          <input type="text" id="newUnit" required>
        </div>
        <div>
          <label for="newSpec">å•†å“è§„æ ¼ï¼š</label>
          <input type="text" id="newSpec" required>
        </div>
        <div>
          <label for="newPrice">å”®ä»·ï¼š</label>
          <input type="number" id="newPrice" step="0.01" required>
        </div>
        <div>
          <label for="newImage">å•†å“å›¾ç‰‡ï¼ˆURLï¼‰ï¼š</label>
          <input type="text" id="newImage">
        </div>
        <button type="button" class="confirm-add-btn" onclick="addNewProduct()">ç¡®è®¤æ·»åŠ </button>
      </form>
    </div>
  </div>

  <script>
    // æ¨¡æ‹Ÿç”Ÿæˆ100æ¡ç¤ºä¾‹æ•°æ®ï¼Œæ“ä½œåˆ—å°†â€œå…¥åº“â€æ”¹ä¸ºâ€œä¿®æ”¹â€
    var data = [];
    for (var i = 1; i <= 100; i++) {
      data.push({
        id: i,
        name: "å•†å“" + i,
        spec: "è§„æ ¼" + i,
        price: (10 + i).toFixed(2),
        stock: Math.floor(Math.random() * 100),
        operation: '<button onclick="alert(\'è¯¦æƒ…å•†å“' + i + '\')">è¯¦æƒ…</button> ' +
                   '<button onclick="alert(\'ä¿®æ”¹å•†å“' + i + '\')">ä¿®æ”¹</button>',
        inDate: i // ç”¨ä½œæ’åºä¾æ®
      });
    }

    var filteredData = data.slice();
    var currentPage = 1;
    var pageSize = parseInt(document.getElementById("pageSize").value);
    var totalPages = Math.ceil(filteredData.length / pageSize);

    function renderTable() {
      var tbody = document.getElementById("inventory-table").getElementsByTagName("tbody")[0];
      tbody.innerHTML = "";
      var start = (currentPage - 1) * pageSize;
      var end = Math.min(start + pageSize, filteredData.length);
      for (var i = start; i < end; i++) {
        var row = filteredData[i];
        var tr = document.createElement("tr");
        tr.innerHTML = "<td>" + row.id + "</td>" +
                       "<td>" + row.name + "</td>" +
                       "<td>" + row.spec + "</td>" +
                       "<td>" + row.price + "</td>" +
                       "<td>" + row.stock + "</td>" +
                       "<td>" + row.operation + "</td>";
        tbody.appendChild(tr);
      }
      document.getElementById("currentPage").innerText = currentPage;
      totalPages = Math.ceil(filteredData.length / pageSize);
      document.getElementById("totalPages").innerText = totalPages;
    }

    function updateFilterAndSort() {
      var query = document.getElementById("searchInput").value.trim().toLowerCase();
      filteredData = data.filter(function(row) {
        return !query ||
          row.id.toString().includes(query) ||
          row.name.toLowerCase().includes(query) ||
          row.price.toString().includes(query);
      });

      var sortOption = document.getElementById("sortSelect").value;
      if (sortOption === "default") {
        filteredData.sort(function(a, b) {
          return a.inDate - b.inDate;
        });
      } else if (sortOption === "name") {
        filteredData.sort(function(a, b) {
          return a.name.localeCompare(b.name);
        });
      } else if (sortOption === "priceAsc") {
        filteredData.sort(function(a, b) {
          return parseFloat(a.price) - parseFloat(b.price);
        });
      } else if (sortOption === "priceDesc") {
        filteredData.sort(function(a, b) {
          return parseFloat(b.price) - parseFloat(a.price);
        });
      } else if (sortOption === "stock") {
        filteredData.sort(function(a, b) {
          return a.stock - b.stock;
        });
      }
      currentPage = 1;
      renderTable();
    }

    // åˆ†é¡µæ§ä»¶äº‹ä»¶
    document.getElementById("prevPage").addEventListener("click", function() {
      if (currentPage > 1) {
        currentPage--;
        renderTable();
      }
    });
    document.getElementById("nextPage").addEventListener("click", function() {
      if (currentPage < totalPages) {
        currentPage++;
        renderTable();
      }
    });
    document.getElementById("jumpBtn").addEventListener("click", function() {
      var jump = parseInt(document.getElementById("jumpPage").value);
      if (jump >= 1 && jump <= totalPages) {
        currentPage = jump;
        renderTable();
      } else {
        alert("è¯·è¾“å…¥æœ‰æ•ˆé¡µç ï¼");
      }
    });
    document.getElementById("pageSize").addEventListener("change", function() {
      pageSize = parseInt(this.value);
      currentPage = 1;
      renderTable();
    });

    // æœç´¢ã€æ’åºã€åˆ·æ–°æ§ä»¶äº‹ä»¶
    document.getElementById("searchInput").addEventListener("input", updateFilterAndSort);
    document.getElementById("searchInput").addEventListener("keydown", function(e) {
      if (e.key === "Enter" || e.keyCode === 13) {
        updateFilterAndSort();
        e.preventDefault();
      }
    });
    document.getElementById("sortSelect").addEventListener("change", updateFilterAndSort);
    document.getElementById("refreshBtn").addEventListener("click", updateFilterAndSort);

    // æ‰¹é‡ä¿®æ”¹æŒ‰é’®äº‹ä»¶
    document.getElementById("batchBtn").addEventListener("click", function() {
      alert("æ‰¹é‡ä¿®æ”¹æ“ä½œ");
    });

    // æ·»åŠ å•†å“æŒ‰é’®äº‹ä»¶ï¼šæ‰“å¼€æ·»åŠ å•†å“æ¨¡æ€çª—å£
    document.getElementById("addProductBtn").addEventListener("click", function() {
      openAddModal();
    });

    // æ‰“å¼€æ·»åŠ å•†å“æ¨¡æ€çª—å£
    function openAddModal() {
      document.getElementById("addModal").style.display = "flex";
    }
    // å…³é—­æ·»åŠ å•†å“æ¨¡æ€çª—å£
    function closeAddModal() {
      document.getElementById("addModal").style.display = "none";
    }
    // ç¡®è®¤æ·»åŠ ï¼šè¯»å–è¡¨å•æ•°æ®ï¼Œæ·»åŠ åˆ° data æ•°ç»„ï¼Œå¹¶æ›´æ–°è¡¨æ ¼
    function addNewProduct() {
      var barcode = document.getElementById("newBarcode").value.trim();
      var name = document.getElementById("newName").value.trim();
      var unit = document.getElementById("newUnit").value.trim();
      var spec = document.getElementById("newSpec").value.trim();
      var price = document.getElementById("newPrice").value.trim();
      var image = document.getElementById("newImage").value.trim();
      if (!barcode || !name || !unit || !spec || !price) {
        alert("è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹ï¼");
        return;
      }
      // æ–°å•†å“IDï¼Œç®€å•ä½¿ç”¨ data é•¿åº¦+1
      var newId = data.length + 1;
      var newProduct = {
        id: newId,
        barcode: barcode,
        name: name,
        unit: unit,
        spec: spec,
        price: parseFloat(price).toFixed(2),
        stock: 0,  // åº“å­˜é»˜è®¤ä¸º0
        // æ“ä½œåˆ—ï¼šè¯¦æƒ…å’Œä¿®æ”¹æŒ‰é’®
        operation: '<button onclick="alert(\'è¯¦æƒ…å•†å“' + newId + '\')">è¯¦æƒ…</button> ' +
                   '<button onclick="alert(\'ä¿®æ”¹å•†å“' + newId + '\')">ä¿®æ”¹</button>',
        inDate: newId  // ç”¨ä½œæ’åºä¾æ®
      };
      data.push(newProduct);
      updateFilterAndSort();
      closeAddModal();
      // æ¸…ç©ºè¡¨å•
      document.getElementById("addProductForm").reset();
      alert("å•†å“å·²æ·»åŠ åˆ°åº“å­˜ä¸­ï¼Œåº“å­˜æ•°é‡é»˜è®¤ä¸º0");
    }

    // åˆå§‹æ¸²æŸ“
    updateFilterAndSort();
  </script>

  <!-- æ¨¡æ€çª—å£ï¼šæ·»åŠ å•†å“ -->
  <div id="addModal">
    <div class="modal-content">
      <div class="modal-header">
        <button class="modal-back-btn" onclick="closeAddModal()">è¿”å›</button>
        <h2>æ·»åŠ å•†å“</h2>
      </div>
      <form id="addProductForm">
        <div>
          <label for="newBarcode">å•†å“æ¡ç ï¼š</label>
          <input type="text" id="newBarcode" required>
        </div>
        <div>
          <label for="newName">å•†å“åç§°ï¼š</label>
          <input type="text" id="newName" required>
        </div>
        <div>
          <label for="newUnit">å•†å“å•ä½ï¼š</label>
          <input type="text" id="newUnit" required>
        </div>
        <div>
          <label for="newSpec">å•†å“è§„æ ¼ï¼š</label>
          <input type="text" id="newSpec" required>
        </div>
        <div>
          <label for="newPrice">å”®ä»·ï¼š</label>
          <input type="number" id="newPrice" step="0.01" required>
        </div>
        <div>
          <label for="newImage">å•†å“å›¾ç‰‡ï¼ˆURLï¼‰ï¼š</label>
          <input type="text" id="newImage">
        </div>
        <button type="button" class="confirm-add-btn" onclick="addNewProduct()">ç¡®è®¤æ·»åŠ </button>
      </form>
    </div>
  </div>
</body>
</html>
